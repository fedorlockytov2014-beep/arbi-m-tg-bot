from typing import Dict, Any, List
from datetime import datetime


def format_today_statistics(stats: Dict[str, Any]) -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ —Å–µ–≥–æ–¥–Ω—è.
    
    Args:
        stats: –î–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        
    Returns:
        str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∑–∞ —Å–µ–≥–æ–¥–Ω—è
    """
    if not stats.get("total_orders", 0):
        return "–ó–∞ —Å–µ–≥–æ–¥–Ω—è –ø—Ä–æ–¥–∞–∂ –Ω–µ –±—ã–ª–æ."
    
    return (
        f"üìÖ –ü—Ä–æ–¥–∞–∂–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è ({datetime.now().strftime('%d.%m.%Y')})\n"
        f" –ó–∞–∫–∞–∑–æ–≤: {stats['total_orders']}\n"
        f" –í—ã—Ä—É—á–∫–∞: {stats['total_revenue']:,} ‚ÇΩ\n"
        f" –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: {stats['avg_check']:,.2f} ‚ÇΩ"
    )


def format_weekly_statistics(stats: Dict[str, Any]) -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –Ω–µ–¥–µ–ª—é.
    
    Args:
        stats: –î–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        
    Returns:
        str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∑–∞ –Ω–µ–¥–µ–ª—é
    """
    if not stats.get("total_orders", 0):
        return "–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂ –Ω–µ –±—ã–ª–æ."
    
    message = (
        f"üìà –ü—Ä–æ–¥–∞–∂–∏ –∑–∞ –Ω–µ–¥–µ–ª—é ({stats.get('date_from', 'N/A')} ‚Äì {stats.get('date_to', 'N/A')})\n"
        f" –ó–∞–∫–∞–∑–æ–≤: {stats['total_orders']}\n"
        f" –í—ã—Ä—É—á–∫–∞: {stats['total_revenue']:,} ‚ÇΩ\n"
        f" –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: {stats['avg_check']:,.2f} ‚ÇΩ"
    )
    
    # –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –¥–Ω—è–º, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
    if "days" in stats and stats["days"]:
        message += "\n\n–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –¥–Ω—è–º:"
        for day_data in stats["days"]:
            message += f"\n{day_data['date']} ‚Äî {day_data['revenue']:,} ‚ÇΩ ({day_data['orders']} –∑–∞–∫–∞–∑–æ–≤)"
    
    return message


def format_monthly_statistics(stats: Dict[str, Any]) -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –º–µ—Å—è—Ü.
    
    Args:
        stats: –î–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        
    Returns:
        str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∑–∞ –º–µ—Å—è—Ü
    """
    if not stats.get("total_orders", 0):
        return "–ó–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –º–µ—Å—è—Ü –ø—Ä–æ–¥–∞–∂ –Ω–µ –±—ã–ª–æ."
    
    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –º–µ—Å—è—Ü –∏ –≥–æ–¥
    month_names = {
        1: "—è–Ω–≤–∞—Ä—å", 2: "—Ñ–µ–≤—Ä–∞–ª—å", 3: "–º–∞—Ä—Ç", 4: "–∞–ø—Ä–µ–ª—å",
        5: "–º–∞–π", 6: "–∏—é–Ω—å", 7: "–∏—é–ª—å", 8: "–∞–≤–≥—É—Å—Ç",
        9: "—Å–µ–Ω—Ç—è–±—Ä—å", 10: "–æ–∫—Ç—è–±—Ä—å", 11: "–Ω–æ—è–±—Ä—å", 12: "–¥–µ–∫–∞–±—Ä—å"
    }
    
    month = stats.get("month", 1)
    year = stats.get("year", datetime.now().year)
    month_name = month_names.get(month, str(month))
    
    return (
        f"üìÜ –ü—Ä–æ–¥–∞–∂–∏ –∑–∞ {month_name} {year}\n"
        f" –ó–∞–∫–∞–∑–æ–≤: {stats['total_orders']}\n"
        f" –í—ã—Ä—É—á–∫–∞: {stats['total_revenue']:,} ‚ÇΩ\n"
        f" –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: {stats['avg_check']:,.2f} ‚ÇΩ"
    )


def format_error_statistics() -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.
    
    Returns:
        str: –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
    """
    return "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É."